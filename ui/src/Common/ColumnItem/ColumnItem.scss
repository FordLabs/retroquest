/*!
 * Copyright (c) 2021 Ford Motor Company
 * All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@import '../../styles/colors';
@import '../../styles/mixins';

$border-width: 2px;
$in-modal-border-width: 8px;
$base-drop-shadow: 0 19px 38px opacity($black, 0.3);

.column-item {
	color: inherit;
	font-weight: bold;
	font-size: 1rem;

	background-color: $white;
	border-radius: 6px;
	box-shadow: 0 1px 2px opacity($black, 0.25);

	transition: none;

	position: relative;

	&.happy {
		&:hover,
		&:focus {
			box-shadow: 0 0 0 $border-width $green;
		}
	}

	&.confused {
		&:hover,
		&:focus {
			box-shadow: 0 0 0 $border-width $blue;
		}
	}

	&.unhappy {
		&:hover,
		&:focus {
			box-shadow: 0 0 0 $border-width $red;
		}
	}

	&.action {
		&:hover,
		&:focus {
			box-shadow: 0 0 0 $border-width $yellow;
		}
	}

	&.editing {
		box-shadow: 0 0 0 4px $purple !important;
	}

	&.deleting {
		box-shadow: 0 0 0 4px $red !important;
	}

	.text-container {
		$padding: 18px;

		border-radius: inherit;
		cursor: pointer;

		position: relative;

		.text-area {
			display: inline-block;
			width: 100%;
			height: 56px;
			min-height: 56px;
			padding: $padding;
			overflow: auto;

			color: inherit;
			font-family: inherit;
			font-weight: inherit;
			font-size: inherit;
			white-space: pre-wrap;
			word-break: break-word;

			background-color: inherit;

			border: 0;
			border-radius: inherit;
			box-shadow: none;
			cursor: default;

			resize: none;

			&[readonly] {
				cursor: pointer;
				caret-color: transparent;
			}
		}

		.floating-character-countdown {
			bottom: 2px;
			right: $padding;
		}
	}

	@media only screen and (max-width: 610px) {
		&.action,
		&.unhappy,
		&.confused,
		&.happy {
			&:hover,
			&:focus {
				box-shadow: 0 1px 2px opacity($black, 0.25);
			}
		}
	}
}

.modal {
	$happy-shadow: 0 0 0 $in-modal-border-width $green, $base-drop-shadow;
	$confused-shadow: 0 0 0 $in-modal-border-width $blue, $base-drop-shadow;
	$unhappy-shadow: 0 0 0 $in-modal-border-width $red, $base-drop-shadow;
	$edit-mode-shadow: 0 0 0 8px $purple, $base-drop-shadow;
	$action-shadow: 0 0 0 $in-modal-border-width $yellow, $base-drop-shadow;

	.column-item {
		width: 450px;
		max-width: 650px;
		height: auto;
		max-height: 50%;

		font-size: 1rem;

		border-radius: 6px;

		@media only screen and (max-width: 610px) {
			width: calc(100% - 16px);
			height: 280px;
			max-height: 280px;
			margin: $in-modal-border-width;

			transform: none;
		}

		&.happy {
			box-shadow: $happy-shadow;
		}

		&.confused {
			box-shadow: $confused-shadow;
		}

		&.unhappy {
			box-shadow: $unhappy-shadow;
		}

		&.action {
			box-shadow: $action-shadow;
		}

		&.deleting {
			box-shadow: $unhappy-shadow !important;
		}

		&.editing {
			box-shadow: $edit-mode-shadow !important;
		}

		&:not(.editing) .text-container {
			cursor: default;
			pointer-events: none;
		}

		.editable-text-select {
			display: none;
		}
	}

	.shake {
		backface-visibility: hidden;
		perspective: 1000px;

		animation: shake 0.5s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
	}

	@media screen and (prefers-reduced-motion: reduce) {
		.shake {
			animation: none;
		}
	}

	@keyframes shake {
		10%,
		90% {
			box-shadow: $unhappy-shadow;
			transform: translate3d(-1px, 0, 0);
		}

		20%,
		80% {
			box-shadow: $unhappy-shadow;
			transform: translate3d(3px, 0, 0);
		}

		30%,
		50%,
		70% {
			box-shadow: $unhappy-shadow;
			transform: translate3d(-6px, 0, 0);
		}

		40%,
		60% {
			box-shadow: $unhappy-shadow;
			transform: translate3d(6px, 0, 0);
		}
	}
}

@include dark-theme {
	.column-item {
		color: $gray;

		background-color: $task-background-dark;
		box-shadow: 0 1px 2px opacity($black, 0.35);

		&.happy {
			&:hover,
			&:focus {
				box-shadow: 0 0 0 $border-width $dark-green;
			}
		}

		&.confused {
			&:hover,
			&:focus {
				box-shadow: 0 0 0 $border-width $belize-hole;
			}
		}

		&.unhappy {
			&:hover,
			&:focus {
				box-shadow: 0 0 0 $border-width $dark-red;
			}
		}

		&.editing {
			box-shadow: 0 0 0 4px $dark-purple !important;
		}
	}

	.modal {
		$happy-shadow-dark: 0 0 0 $in-modal-border-width $dark-green,
			$base-drop-shadow;
		$confused-shadow-dark: 0 0 0 $in-modal-border-width $belize-hole,
			$base-drop-shadow;
		$unhappy-shadow-dark: 0 0 0 $in-modal-border-width $dark-red,
			$base-drop-shadow;
		$edit-mode-shadow-dark: 0 0 0 8px $dark-purple, $base-drop-shadow;
		$action-shadow-dark: 0 0 0 $in-modal-border-width $dark-yellow,
			$base-drop-shadow;

		.column-item {
			&.happy {
				box-shadow: $happy-shadow-dark;
			}

			&.confused {
				box-shadow: $confused-shadow-dark;
			}

			&.unhappy {
				box-shadow: $unhappy-shadow-dark;
			}

			&.action {
				box-shadow: $action-shadow-dark;
			}

			&.deleting {
				box-shadow: $unhappy-shadow-dark !important;
			}

			&.editing {
				box-shadow: $edit-mode-shadow-dark !important;
			}
		}
	}
}
